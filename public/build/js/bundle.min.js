var marker=document.querySelector("#marker"),item=document.querySelectorAll("nav a");function indicator(e){marker.style.left=e.offsetLeft+"px",marker.style.width=e.offsetWidth+"px"}item.forEach(e=>{e.addEventListener("mousemove",e=>{indicator(e.target)})});const items=document.querySelectorAll(".accordion button");function toggleAccordion(){const e=this.getAttribute("aria-expanded");for(i=0;i<items.length;i++)items[i].setAttribute("aria-expanded","false");"false"==e&&this.setAttribute("aria-expanded","true")}items.forEach(e=>e.addEventListener("click",toggleAccordion));const options=document.querySelectorAll(".option");options.forEach(e=>{e.addEventListener("click",e=>{options.forEach(e=>e.classList.remove("active")),e.target.closest(".option").classList.add("active")})});let paso=1;const pasoInicial=1,pasoFinal=3;let venta={id:"",nombre:"",celular:"",direccion:"",entre:"",codigo:"",carrito:[]},{carrito:carrito}=venta;function iniciarApp(){mostrarSeccion(),tabs(),botonesPaginador(),paginaSiguiente(),paginaAnterior(),consultarApi(),sinStock(),idUser(),datosCliente(),mostrarResumen()}function mostrarSeccion(){const e=document.querySelector(".mostrar");e&&e.classList.remove("mostrar");const t="#paso-"+paso;document.querySelector(t).classList.add("mostrar");const n=document.querySelector(".actual");n&&n.classList.remove("actual");document.querySelector(`[data-paso="${paso}"]`).classList.add("actual")}function tabs(){document.querySelectorAll(".img-btn").forEach(e=>{e.addEventListener("click",(function(e){paso=parseInt(e.target.dataset.paso),mostrarSeccion(),botonesPaginador()}))})}function botonesPaginador(){const e=document.querySelector("#anterior"),t=document.querySelector("#siguiente");1===paso?(e.classList.add("ocultar"),t.classList.remove("ocultar")):3===paso?(e.classList.remove("ocultar"),t.classList.add("ocultar"),mostrarResumen()):(e.classList.remove("ocultar"),t.classList.remove("ocultar")),mostrarSeccion()}function paginaAnterior(){document.querySelector("#anterior").addEventListener("click",()=>{paso<=1||(paso--,botonesPaginador())})}function paginaSiguiente(){document.querySelector("#siguiente").addEventListener("click",()=>{paso>=3||(paso++,botonesPaginador())})}async function consultarApi(){try{const e="https://encens.herokuapp.com/api/carrito",t=await fetch(e);mostrarSahumerios(await t.json())}catch(e){console.log(e)}}function mostrarSahumerios(e){e.forEach(e=>{const{id:t,nombre:n,marca:o,imagen:a,precio:r,descripcion:c}=e,i=document.createElement("IMG");i.classList.add("img-anuncio"),i.src="/img/"+a;const s=document.createElement("DIV");s.classList.add("caja-imagen"),s.appendChild(i),s.addEventListener("click",()=>{Swal.fire({title:""+n,text:""+c,imageUrl:"/img/"+a,width:400,imageHeight:350,imageAlt:""+n})});const l=document.createElement("H3");l.textContent=n;const d=document.createElement("P");d.textContent=o;const u=document.createElement("P");u.classList.add("precio"),u.textContent="$"+r;const m=document.createElement("BUTTON"),p=document.querySelector("#autenticado");m.classList.add("agregar"),m.textContent="",m.dataset.idSahumerio=t,m.onclick=function(){p?(seleccionarProducto(e),agregarAlCarro(e.id)):Swal.fire("Tenes que iniciar sesión !")};const A=document.createElement("DIV");A.classList.add("precio-agregar"),A.appendChild(u),A.appendChild(m);const f=document.createElement("DIV");f.classList.add("producto"),f.appendChild(s),f.appendChild(l),f.appendChild(d),f.appendChild(A),document.querySelector(".caja-productos").appendChild(f)})}document.addEventListener("DOMContentLoaded",(function(){iniciarApp(),localStorage.getItem("carro")&&(carro=JSON.parse(localStorage.getItem("carro")),actualizarCarro()),localStorage.getItem("venta")&&(venta=JSON.parse(localStorage.getItem("venta")))}));let carro=[];const contenedorCarro=document.querySelector(".lista-carro"),contadorCarro=document.querySelector("#contador"),precioTotal=document.querySelector("#total"),agregarAlCarro=e=>{const t=carro.some(t=>t.id===e),{carrito:n}=venta;if(t){carro.map(t=>{t.id===e&&(t.cantidad<t.stock?t.cantidad++:t.cantidad=t.stock)})}else{const t=n.find(t=>t.id===e);carro.push(t),console.log(carro)}actualizarCarro()};function sinStock(){const e=document.querySelectorAll(".producto");0===sahumerio.cantidad?e.classList.add("sinStock"):e.classList.remove("sinStock")}const eliminarDelCarro=()=>{const e=carro.find(e=>e.id);console.log(e);const t=carro.indexOf(e),{carrito:n}=venta,o=n.find(e=>e.id),a=n.indexOf(o);carro.splice(t,1),n.splice(a,1),localStorage.removeItem("item"),localStorage.removeItem("carrito"),0===carro.length&&(localStorage.removeItem("carro"),localStorage.removeItem("venta")),actualizarCarro()},actualizarCarro=()=>{contenedorCarro.innerHTML="";let{carrito:e}=venta;carro.forEach(e=>{const t=document.createElement("div");t.className="producto-carro",t.innerHTML=`\n    <img src="/img/${e.imagen}">\n    <div>\n      <p>${e.nombre}</p>\n      <p>${e.marca}</p>\n      <p>$${e.precio}</p>\n      \n      <p>Cantidad: ${e.cantidad}</p>\n    </div>\n    <button class="eliminar"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-trash" width="25" height="25" viewBox="0 0 24 24" stroke-width="1.5" stroke="#ff2825" fill="none" stroke-linecap="round" stroke-linejoin="round">\n    <path stroke="none" d="M0 0h24v24H0z" fill="none"/>\n    <line x1="4" y1="7" x2="20" y2="7" />\n    <line x1="10" y1="11" x2="10" y2="17" />\n    <line x1="14" y1="11" x2="14" y2="17" />\n    <path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12" />\n    <path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3" />\n    </svg></button>\n    `,contenedorCarro.appendChild(t),localStorage.setItem("carro",JSON.stringify(carro))}),contadorCarro.innerText=carro.length,precioTotal.innerText=carro.reduce((e,t)=>e+t.precio*t.cantidad,0);document.querySelectorAll(".eliminar").forEach(e=>{e.addEventListener("click",()=>{eliminarDelCarro()})})};function seleccionarProducto(e){const{id:t}=e,{carrito:n}=venta;n.some(e=>e.id===t)?e.length++:venta.carrito=[...n,e],console.log(venta)}function idUser(){venta.id=document.querySelector("#idUser").value}function datosCliente(){const e=document.querySelector("#nombre-venta");e.addEventListener("input",(function(t){venta.nombre=e.value}));const t=document.querySelector("#celular-venta");t.addEventListener("input",(function(e){venta.celular=t.value}));const n=document.querySelector("#direccion-venta");n.addEventListener("input",(function(e){venta.direccion=n.value}));const o=document.querySelector("#entre-venta");o.addEventListener("input",(function(e){venta.entre=o.value}));const a=document.querySelector("#codigo-venta");a.addEventListener("input",(function(e){venta.codigo=a.value})),console.log(venta)}function mostrarAlerta(e,t,n,o=!0){const a=document.createElement("DIV");a.textContent=e,a.classList.add("alerta"),a.classList.add(t);document.querySelector(n).appendChild(a),o&&setTimeout(()=>{a.remove()},3e3)}function mostrarResumen(){const e=document.querySelector(".contenido-resumen");actualizarCarro();const t=document.querySelector(".caja-iniciar-resumen");for(;e.firstChild;)e.removeChild(e.firstChild);if(Object.values(venta).includes("")||0===venta.carrito.length||t)return void mostrarAlerta("Faltan datos o seleccionar productos","error",".contenido-resumen",!1);const n=document.createElement("H3");n.textContent="Resumen",e.appendChild(n);const{nombre:o,celular:a,direccion:r,entre:c,codigo:i,carrito:s}=venta,l=document.createElement("P");l.innerHTML=`<span>Nombre: ${o}</span>`;const d=document.createElement("P");d.innerHTML=`<span>Celular: ${a}</span>`;const u=document.createElement("P");u.innerHTML=`<span>Direccion: ${r}</span>`;const m=document.createElement("P");m.innerHTML=`<span>Entre Calles: ${c}</span>`;const p=document.createElement("P");p.innerHTML=`<span>Codigo Postal: ${i}</span>`;const A=document.createElement("DIV");s.forEach(t=>{const{id:n,imagen:o,nombre:a,marca:r,precio:c,cantidad:i}=t,s=document.createElement("DIV");s.classList.add("datos");const l=document.createElement("DIV"),d=document.createElement("DIV");d.classList.add("contenedor-sahumerios-datos");const u=document.createElement("IMG");u.classList.add("img-anuncio"),u.src="/img/"+o;const m=document.createElement("P");m.textContent=a;const p=document.createElement("P");p.textContent=r;const A=document.createElement("P");A.innerHTML=`<span>$${c}</span>`;const f=document.createElement("P");f.innerHTML=`<span>Cantidad: ${i}</span>`,l.appendChild(u),s.appendChild(m),s.appendChild(p),s.appendChild(A),s.appendChild(f),d.appendChild(l),d.appendChild(s),e.appendChild(d)}),A.classList.add("caja-datos-resumen"),A.appendChild(l),A.appendChild(d),A.appendChild(u),A.appendChild(m),A.appendChild(p),e.appendChild(A);const f=s.reduce((e,t)=>e+t.precio*t.cantidad,0),v=document.createElement("DIV");v.classList.add("totales"),v.innerHTML=`TOTAL: $<span>${f}</span>`,e.appendChild(v);const g=document.createElement("DIV");g.classList.add("container-btn"),g.classList.add("btn-resumen"),g.innerHTML='\n    <a class="button">\n      <div class="button__line"></div>\n      <div class="button__line"></div>\n      <span class="button__text">Hacer Pedido</span>\n      <div class="button__drow1 violeta"></div>\n      <div class="button__drow2 violeta"></div>\n    </a>\n  ',g.onclick=realizarPedido,e.appendChild(g),localStorage.setItem("venta",JSON.stringify(venta))}async function realizarPedido(){const{id:e,nombre:t,celular:n,direccion:o,entre:a,codigo:r,carrito:c}=venta,i=c.map(e=>e.id),s=c.map(e=>e.cantidad),l=new FormData;l.append("nombre",t),l.append("celular",n),l.append("direccion",o),l.append("entre",a),l.append("codigo",r),l.append("usuarios_id",e),l.append("carrito",i),l.append("cantidad",s);try{const e="https://encens.herokuapp.com/api/venta",t=await fetch(e,{method:"POST",body:l}),n=await t.json();n.resultado&&Swal.fire({position:"center",icon:"success",title:"Pedido Realizado Correctamente",showConfirmButton:!1,timer:3500}).then(()=>{window.location.reload(),localStorage.removeItem("carro")}),console.log(n.resultado)}catch(e){Swal.fire({icon:"error",title:"Error",text:"No se pudo realizar el pedido. ¡Volve a intentarlo!"})}}
//! Animacion hover
function translateActive(){carritoCompleto.style.transform="translateX(0px)"}function translateNormal(){carritoCompleto.style.transform="translateX(380px)"}function zindexFull(){carritoCompleto.style.zIndex="100"}function zindexNormal(){carritoCompleto.style.zIndex="80"}carritoCompleto=document.querySelector(".carrito"),carritoChiquito=document.querySelector(".img-carrito"),cerrarCarrito=document.querySelector(".cerrar-carrito"),body=document.querySelector(".body"),carritoChiquito.addEventListener("click",translateActive),carritoChiquito.addEventListener("click",zindexFull),cerrarCarrito.addEventListener("click",translateNormal),cerrarCarrito.addEventListener("click",zindexNormal),function(e,t,n){function o(e,t){return typeof e===t}function a(e){var t=u.className,n=l._config.classPrefix||"";if(m&&(t=t.baseVal),l._config.enableJSClass){var o=new RegExp("(^|\\s)"+n+"no-js(\\s|$)");t=t.replace(o,"$1"+n+"js$2")}l._config.enableClasses&&(t+=" "+n+e.join(" "+n),m?u.className.baseVal=t:u.className=t)}function r(e,t){if("object"==typeof e)for(var n in e)d(e,n)&&r(n,e[n]);else{var o=(e=e.toLowerCase()).split("."),c=l[o[0]];if(2==o.length&&(c=c[o[1]]),void 0!==c)return l;t="function"==typeof t?t():t,1==o.length?l[o[0]]=t:(!l[o[0]]||l[o[0]]instanceof Boolean||(l[o[0]]=new Boolean(l[o[0]])),l[o[0]][o[1]]=t),a([(t&&0!=t?"":"no-")+o.join("-")]),l._trigger(e,t)}return l}var c=[],i=[],s={_version:"3.6.0",_config:{classPrefix:"",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(e,t){var n=this;setTimeout((function(){t(n[e])}),0)},addTest:function(e,t,n){i.push({name:e,fn:t,options:n})},addAsyncTest:function(e){i.push({name:null,fn:e})}},l=function(){};l.prototype=s,l=new l;var d,u=t.documentElement,m="svg"===u.nodeName.toLowerCase();!function(){var e={}.hasOwnProperty;d=o(e,"undefined")||o(e.call,"undefined")?function(e,t){return t in e&&o(e.constructor.prototype[t],"undefined")}:function(t,n){return e.call(t,n)}}(),s._l={},s.on=function(e,t){this._l[e]||(this._l[e]=[]),this._l[e].push(t),l.hasOwnProperty(e)&&setTimeout((function(){l._trigger(e,l[e])}),0)},s._trigger=function(e,t){if(this._l[e]){var n=this._l[e];setTimeout((function(){var e;for(e=0;e<n.length;e++)(0,n[e])(t)}),0),delete this._l[e]}},l._q.push((function(){s.addTest=r})),l.addAsyncTest((function(){function e(e,t,n){function o(t){var o=!(!t||"load"!==t.type)&&1==a.width;r(e,"webp"===e&&o?new Boolean(o):o),n&&n(t)}var a=new Image;a.onerror=o,a.onload=o,a.src=t}var t=[{uri:"data:image/webp;base64,UklGRiQAAABXRUJQVlA4IBgAAAAwAQCdASoBAAEAAwA0JaQAA3AA/vuUAAA=",name:"webp"},{uri:"data:image/webp;base64,UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAABBxAR/Q9ERP8DAABWUDggGAAAADABAJ0BKgEAAQADADQlpAADcAD++/1QAA==",name:"webp.alpha"},{uri:"data:image/webp;base64,UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA",name:"webp.animation"},{uri:"data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=",name:"webp.lossless"}],n=t.shift();e(n.name,n.uri,(function(n){if(n&&"load"===n.type)for(var o=0;o<t.length;o++)e(t[o].name,t[o].uri)}))})),function(){var e,t,n,a,r,s;for(var d in i)if(i.hasOwnProperty(d)){if(e=[],(t=i[d]).name&&(e.push(t.name.toLowerCase()),t.options&&t.options.aliases&&t.options.aliases.length))for(n=0;n<t.options.aliases.length;n++)e.push(t.options.aliases[n].toLowerCase());for(a=o(t.fn,"function")?t.fn():t.fn,r=0;r<e.length;r++)1===(s=e[r].split(".")).length?l[s[0]]=a:(!l[s[0]]||l[s[0]]instanceof Boolean||(l[s[0]]=new Boolean(l[s[0]])),l[s[0]][s[1]]=a),c.push((a?"":"no-")+s.join("-"))}}(),a(c),delete s.addTest,delete s.addAsyncTest;for(var p=0;p<l._q.length;p++)l._q[p]();e.Modernizr=l}(window,document);
//# sourceMappingURL=bundle.js.map
